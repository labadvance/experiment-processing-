# README: Анализ пористой среды с использованием PoreSpy и OpenPNM

Этот проект предназначен для анализа изображений пористой среды, вычисления пористости, проницаемости и визуализации распределения давления в порах с использованием библиотек Python: PoreSpy и OpenPNM.

## Предварительные требования

### Необходимые библиотеки Python
- `porespy`
- `openpnm`
- `numpy`
- `matplotlib`
- `scikit-image`

Установите зависимости с помощью pip:
```bash
pip install porespy openpnm numpy matplotlib scikit-image
```

## Описание процесса

### Шаг 1: Предобработка изображения
1. **Загрузка изображения:** Скрипт загружает файл изображения с именем `krugi3 1.png`. Убедитесь, что файл находится в рабочей директории.
2. **Преобразование в оттенки серого:** Если изображение цветное (RGB или RGBA), оно преобразуется в оттенки серого.
3. **Бинаризация:** Изображение преобразуется в бинарное с использованием метода Отсу для выделения пористой структуры.
4. **Инверсия:** Бинарное изображение инвертируется, чтобы поры были представлены значениями `True`.
5. **Расчет пористости:** Пористость вычисляется как отношение количества пористых пикселей к общему числу пикселей на изображении.

### Шаг 2: Извлечение сетки пор (SNOW2)
1. Бинарное изображение обрабатывается с использованием функции `snow2` из PoreSpy для извлечения сетки пор.
2. Результирующая сетка импортируется в OpenPNM для дальнейшего анализа.

### Шаг 3: Настройка сетки
1. **Геометрические свойства:** Порам и горловинам присваиваются такие свойства, как диаметр, длина и гидравлические размеры, с использованием моделей OpenPNM.
2. **Изолированные поры:** Проверяется наличие изолированных пор. Если они обнаружены, они удаляются, и модели регенерируются.

### Шаг 4: Граничные условия и моделирование потока
1. Определяются граничные поры в верхней и нижней частях сети.
2. Применяются граничные условия давления (1 МПа сверху и 0 Па снизу).
3. Выполняется моделирование течения с использованием алгоритмов OpenPNM.

### Шаг 5: Расчет проницаемости
Проницаемость вычисляется по закону Дарси:

\[
K = \frac{Q \cdot \mu \cdot L}{A \cdot \Delta P}
\]

где:
- \(Q\): Объемный расход
- \(\mu\): Вязкость жидкости (Па\cdotс)
- \(L\): Длина области (м)
- \(A\): Площадь поперечного сечения (м\(^2\))
- \(\Delta P\): Перепад давления (Па)

### Шаг 6: Визуализация
1. Отображается бинарное изображение.
2. Распределение давления в порах визуализируется в виде цветовой карты поверх сетки пор.

## Выводы
- **Пористость:** Выводится в консоль.
- **Проницаемость:** Отображается в миллиДарси (mD).
- **Объемный расход:** Выводится общий объемный расход.
- **Визуализации:**
  - Бинарное изображение пористой структуры.
  - Цветовая карта распределения давления в сетке пор.

## Требования к файлам
- Входной файл: `krugi3 1.png` (изображение пористой среды).

## Запуск скрипта
Запустите скрипт с помощью Python:
```bash
python porous_media_analysis.py
```
Убедитесь, что входной файл находится в рабочей директории.

## Пример вывода
### Консоль:
```
Пористость: 0.3567
Проницаемость: 15.34 мДарси
Объемный расход: 4.23e-08 м^3/с
Количество изолированных пор: 0
Всего пор в сети: 1245
```

### Визуализация:
1. Бинарное изображение пористой структуры.
2. Цветовая карта распределения давления в сети пор.

## Примечания
- Измените `voxel_size` в соответствии с разрешением вашего изображения.
- При необходимости отредактируйте имя входного файла.
- Убедитесь, что разрешение изображения и масштабирование подходят для корректного расчета проницаемости.

